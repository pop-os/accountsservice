From: Frederic Peters <fpeters@debian.org>
Bug-Debian: http://bugs.debian.org/618764
Description: Do not consider system users returned from consolekit history.
Forwarded: not-needed
---
 src/daemon.c |    5 ++++-
 1 files changed, 4 insertions(+), 1 deletions(-)

diff --git a/src/daemon.c b/src/daemon.c
index 32e9c97..a32276b 100644
--- a/src/daemon.c
+++ b/src/daemon.c
@@ -336,6 +336,7 @@ process_ck_history_line (Daemon      *daemon,
         gchar *username;
         gulong frequency;
         User *user;
+        struct passwd *pw;
 
         frequency = 0;
         username = NULL;
@@ -344,7 +345,9 @@ process_ck_history_line (Daemon      *daemon,
                 return;
         }
 
-        if (user_is_excluded (daemon, username, daemon->priv->minimal_uid)) {
+        pw = getpwnam (username);
+
+        if (user_is_excluded (daemon, username, pw->pw_uid)) {
                 g_debug ("excluding user '%s'", username);
                 g_free (username);
                 return;
-- 
1.7.4.1

